config:
  user.network-config: |
    version: 1
    config:      
      - type: physical
        name: eth0
        subnets:
          - type: dhcp
            ipv4: true
            control: auto
            
  user.user-data: |
    #cloud-config

    #the last commands stop docker daemon
    #then enables it to be run at boot
    # /etc/systemd/system/docker.service.d is where we configure dockerd proxy settings
    #zfsutils-linux zfs-initramfs
    runcmd:
      - curl -fsSL get.docker.com -o get-docker.sh
      - sh get-docker.sh
      - apt install -y slurm tcptrack nmap docker-compose wait-for-it jq
      - mkdir -p /etc/systemd/system/docker.service.d       
      - systemctl stop docker
      - systemctl enable docker
      - echo "Done installing docker."

description:
devices:
  eth0:
    nictype: bridged
    parent: lxdbr0
    type: nic
  root:
    path: /
    pool: bcm_data
    type: disk
name: docker.yml




    # # so remote docker-machine can pull in and provision node
    # users:
    # - name: root
    #   ssh-authorized-keys:
    #     - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCou4a97Q5YItoICedUzSurtgVFK95AmF6i4148xzdLDe5DHpMl1hzBdAHqq1mMf6YSW2kqThekczY5P3Sd0GU/EWhtubvIAiCh1y/Bn2ViL/7K3YxwYkILVmHggRhBax+6JRqTgutV3kx7Gfo3D0ZsgjEDI5jq4JYw5eRE9ID5XvG5M6XNg544SwkWTqGFOFw8Mlcoe0VkXlM4BR/JhtMl0M7+sjtSoxtDUhWwA8FzSOvq4kyztnNrZsNWI0PkRP9jul25ydJLVquXiEBEwQusA3j4wIQuHuYydDX7pky8aakUnEXAeCi8SwBXsnWHsAIdvtm3Qh/qYWEN0q/MvmSp derek@farscapian.com
    #   sudo: ['ALL=(ALL) NOPASSWD:ALL']
    #   groups: sudo
    #   shell: /bin/bash

    # ssh_keys:  #this private key is for manager1 to login to manager2 and 3 and workers.
    #   rsa_private: |
    #     -----BEGIN RSA PRIVATE KEY-----
    #     MIIEowIBAAKCAQEAqLuGve0OWCLaCAnnVM0rq7YFRSveQJheouNePMc3Sw3uQx6T
    #     JdYcwXQB6qtZjH+mEltpKk4XpHM2OT90ndBlPxFobbm7yAIgodcvwZ9lYi/+yt2M
    #     cGJCC1Zh4IEYQWsfuiUak4LrVd5Mexn6Nw9GbIIxAyOY6uCWMOXkRPSA+V7xuTOl
    #     zYOeOEsJFk6hhThcPDJXKHtFZF5TOAUfyYbTJdDO/rI7UqMbQ1IVsAPBc0jr6uJM
    #     s7Zza2bDViND5ET/Y7pducnSS1arl4hARMELrAN4+MCELh7mMnQ1+6ZMvGmpFJxF
    #     wHgovEsAV7J1h7ACHb7Zt0If6mFhDdKvzL5kqQIDAQABAoIBAG/aqK79GBY7PFg5
    #     4H2p6TpSVtoNA6/Ekm/e1BjsY25A1OLvwNJDRxrDQYYEgz+NW1Ut/eBKloewzJBU
    #     zYTUolmVu6mJh79GEcXXtdPgS8A0Wu62waO6r1d+szG1wpOTZRvr/tss3b81t3Of
    #     u+yGFsRV5hHTpkqGCWpu68z+XQVx5LO8wMF3LmBpHKG48365Tvv/SUAUUcEomE49
    #     ade6CjSR+zq0CcMZ3Wn/ny5cOcuhph06r2uth8ZyIyx7n2M7389KOAynmxS9iccE
    #     WqVDDOU4HPxyJpTJJPSiQu2TTwpPCB4LXqM7w4M2/YjMUX6tWJMhpXWp1c4TqHqH
    #     3RtWJ2UCgYEA0HHN3Vr7bPk37qb1cnEBXZAT2ypSHwIO+OlGd9funu7nryC2sWi8
    #     AwpHm1tUpIGc/VHi6S1wFLMRFpM05CyK4AMYm2ZS08XD0Akd73fEdaKhJiZYAWES
    #     gGgaWbCMZCUkcL9oINSqYNEHHTkxkiYPmmoncSLnJmlfXdqBXh/hZ98CgYEAzzpX
    #     zxfFI7a1E4YmIUNQlnMjDjOSrgncgs1IONb0iLijlRCoFJTMpuMauPHXOPIxhESf
    #     vN1Uwb/rORmCzpMD4n09ZVlRb9sxrOPorrS8IgX76pqNZ12m9anIJzYv8uSsh+eh
    #     L9wlI4wxR7YeWhqHTTA19evYeHJePqGVBq4cZHcCgYEAgsDAmDf4O3Vhhoyorq8A
    #     YkZ8jiBP/y91YOJD1+1Vu9C0+IAW2daPCYErReLWh5LefXEeW5KrGfDxqS2SIgdm
    #     3fpTNzfKgRkvKZJuesawL/JiD+JBlivkRTQIQ3ahujgqUadflCiS78RvJ/+2fqzt
    #     YLlyIF/6i3fR4LeuKvLonBUCgYBPt5bt4KwCuBdiYlmqtBV9Ot+CaA6GCt8cJlIh
    #     I3fAXJ75CgZOnIs5q+WsvcPYcTrhMfDtG4uuWODo/0pVozJ8X0dOBJUSXZT3eFkb
    #     VAWHZRvqvPemit1eZajMhMjfPF6ujUlxetOCoDyY5JM6gDgKVoB7kPWeKAjfORN2
    #     FWZwswKBgBTNPcPwA2tJUAhAmKkKdqEr15MvrsWc+sNPlCQBur9PcEJXd4yZ9Quu
    #     s8KLuMXdis7DRF/5Ks6DVU4Evtkbi3Gt8XD+GsOXzefgFKj9UkIFbyNEeJGfVCBR
    #     pXTUM37GlTzpD/XoTaQeM/Z+tn+/QwJ/B6JnLjoSYtKDSViQI2Xx
    #     -----END RSA PRIVATE KEY-----
    #   rsa_public: ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCou4a97Q5YItoICedUzSurtgVFK95AmF6i4148xzdLDe5DHpMl1hzBdAHqq1mMf6YSW2kqThekczY5P3Sd0GU/EWhtubvIAiCh1y/Bn2ViL/7K3YxwYkILVmHggRhBax+6JRqTgutV3kx7Gfo3D0ZsgjEDI5jq4JYw5eRE9ID5XvG5M6XNg544SwkWTqGFOFw8Mlcoe0VkXlM4BR/JhtMl0M7+sjtSoxtDUhWwA8FzSOvq4kyztnNrZsNWI0PkRP9jul25ydJLVquXiEBEwQusA3j4wIQuHuYydDX7pky8aakUnEXAeCi8SwBXsnWHsAIdvtm3Qh/qYWEN0q/MvmSp derek@farscapian.com

      # - curl -O https://prerelease.keybase.io/keybase_amd64.deb
      # - dpkg -i keybase_amd64.deb
      # - apt-get install -f
      # - run_keybase