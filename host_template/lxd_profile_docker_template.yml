config:
  user.network-config: |
    version: 1
    config:      
      - type: physical
        name: eth0
        subnets:
          - type: dhcp
            ipv4: true
            control: auto
            
  user.user-data: |
    #cloud-config

    #the last commands stop docker daemon
    #then enables it to be run at boot
    # /etc/systemd/system/docker.service.d is where we configure dockerd proxy settings
    #zfsutils-linux zfs-initramfs
    runcmd:
      - curl -fsSL get.docker.com -o get-docker.sh
      - sh get-docker.sh
      - apt install -y slurm tcptrack nmap docker-compose wait-for-it jq
      - mkdir -p /etc/systemd/system/docker.service.d       
      - systemctl stop docker
      - systemctl enable docker
      - echo "Done installing docker."

description:
devices:
  eth0:
    nictype: bridged
    parent: lxdbr0
    type: nic
  root:
    path: /
    pool: bcm_data
    type: disk
name: docker.yml
